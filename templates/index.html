<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>PROSIT</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/style.css" rel="stylesheet">
</head>

<body>
    <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script> -->

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF" crossorigin="anonymous"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/1.1.1/js/bootstrap-multiselect.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/1.1.1/css/bootstrap-multiselect.css">

    <!--[if lt IE 7]><p class="browsehappy">You are using an <strong>outdated</strong>browser. Please <a href="#">upgrade your browser</a>to improve your experience.</p><![endif]-->
    <div class="container-fluid" style="height:100%">
        <div class="row flex-nowrap" style="height:100%">
            <div class="col-auto px-0">
                <div id="sidebar" class="collapse collapse-horizontal show border-end">
                    <div id="sidebar-nav" class="list-group border-0 rounded-0 text-sm-start min-vh-100">

                        <h4 id="dashboardHeader">Filters</h4>
                        <hr class="line">

                        <div style="padding-left:10px; padding-right:10px;">
                            <input type="search" id="form1" class="form-control" placeholder="Rules query" aria-label="Search" />
                        </div>

                        <hr class="line">

                        <div style="padding-left:10px;">
                            <label> Feature selection</label>
                            <select id="featureSelect" multiple>
                            <optgroup label="Screen">
                                <option value="noScreenLocks" selected="selected">No of Unlocks</option>
                                <option value="firstScreenUnlock" selected="selected">First Screen Unlock</option>
                                <option value="lastScreenLock" selected="selected">Last Screen Lock</option>
                                <option value="maxScreenTime" selected="selected">Max On time</option>
                                <option value="totalScreenTime" selected="selected">Total On time</option>
                            </optgroup>

                            <optgroup label="Calling">
                                <option value="noMissed" selected="selected">No of missed calls</option>
                                <option value="noDialled" selected="selected">No of dialed calls</option>
                                <option value="noIncoming" selected="selected">No of incoming calls</option>
                                <option value="minDurationIncoming" selected="selected">Min dur of incoming calls</option>
                                <option value="maxDurationIncoming" selected="selected">Max dur of incoming calls</option>
                                <option value="totalDurationIncoming" selected="selected">Total dur of incoming calls</option>
                                <option value="noOutgoing" selected="selected">No of outgoing calls</option>
                                <option value="minDurationOutgoing" selected="selected">Min dur of outgoing calls</option>
                                <option value="maxDurtaionOutgoing" selected="selected">Max dur of outgoing calls</option>
                                <option value="totalDurationOutgoing" selected="selected">Total dur of outgoing calls</option>
                                <option value="totalNoCalls" selected="selected">Total number of calls</option>
                                <option value="totalDurationCalls" selected="selected">Total dur of all calls</option>
                            </optgroup>

                            <optgroup label="Mobility">
                                <option value="stepCount" selected="selected">No of steps</option>
                                <option value="totalDistance" selected="selected">Total Distance</option>
                                <option value="noStayPoints" selected="selected">No of Stay Points</option>
                                <option value="locationVariance" selected="selected">Location Variance</option>
                                <option value="locationEntropy" selected="selected">Location Entropy</option>
                            </optgroup>

                            <optgroup label="Sleep">
                                <option value="sleepStartTime1" selected="selected">Sleep start time 1</option>
                                <option value="sleepEndTime1" selected="selected">Sleep end time 1</option>
                                <option value="sleepDuration1" selected="selected">Sleep duration 1</option>
                                <option value="sleepStartTime2" selected="selected">Sleep start time 2</option>
                                <option value="sleepEndTime2" selected="selected">Sleep end time 2</option>
                                <option value="sleepDuration2" selected="selected">Sleep duration 2</option>
                                <option value="totalSleepDuration" selected="selected">Total Sleep duration</option>
                                <option value="noSleepInterruptions" selected="selected">No of sleep Interruptions</option>
                            </optgroup>
                        </select>
                        </div>

                        <div class="container" style="padding-top: 5px;">
                            <div class="row">
                                <div class="col text-center">
                                    <button class="btn btn-outline-primary btn-sm" id="featureSelectFilter">Submit</button>
                                </div>
                            </div>
                        </div>

                        <hr class="line">

                        <!-- <div class="box" style="text-align: center;">
                            <div class="rangeSlider">
                                <input type="range" class="circleRange" min="0" max="10" value="6">
                            </div>
                            <div class="value"></div>
                        </div> -->

                        <div class="slidecontainer" style="text-align: center; padding-left:10px; padding-bottom:0px">
                            <p>Glyph Radius: </p>

                            <span id="sliderVal"></span>
                            <br>
                            <div>
                                <input type="range" min="1" max="30" value="10" steps='1' class="slider" id="myRange">
                            </div>
                        </div>

                        <hr class="line">
                        <!-- Toggle glyph switch -->
                        <div>
                            <label class="form-check-label" for="toggleGlyph" style="text-align: center;">Toggle Glyph</label>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" role="switch" id="toggleGlyph" style="float: none; margin-left: 20%;" />
                            </div>
                        </div>

                        <hr class="line">

                        <!-- Toggle polar chart switch -->
                        <div>
                            <label class="form-check-label" for="toggleGlyph" style="text-align: center;">Toggle Polar chart</label>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" role="switch" id="togglePolarChart" style="float: none; margin-left: 20%;" />
                            </div>
                        </div>

                        <hr class="line">

                        <div>
                            <table style="width:100%;">
                                <tr>
                                    <td class="filterCheckbox">
                                        <input type="checkbox" id="brtCheckBox" checked>
                                        <br>
                                        <label>BRT</label>
                                    </td>
                                    <td class="filterCheckbox">
                                        <input type="checkbox" id="accCheckBox">
                                        <br>
                                        <label>ACC</label>
                                    </td>
                                    <td class="filterCheckbox">
                                        <input type="checkbox" id="gyrCheckBox">
                                        <br>
                                        <label>GYR</label>
                                    </td>
                                    <td class="filterCheckbox">
                                        <input type="checkbox" id="lckCheckBox">
                                        <br>
                                        <label>LCK</label>
                                    </td>
                                </tr>
                            </table>

                        </div>

                        <hr class="line">


                        <div style="display:flex; justify-content: center; align-items: center;">
                            <button type="button" class="btn btn-outline-primary btn-sm">Submit</button>
                        </div>
                    </div>
                </div>
            </div>
            <main class="col ps-md-2 pb-10">
                <div class="row py-2" id="header">
                    <div class="col-1">
                        <a data-toggle="collapse" href="#" data-target="#sidebar" aria-expanded="false">Menu</a>
                        <!-- <a href="#" data-bs-target="#sidebar" data-bs-toggle="collapse" class="border rounded-3 p-1 text-decoration-none"> -->
                        </a>
                    </div>
                    <div class="col-11" style="text-align:left;">
                        <h4 id="dashboardHeader">PROSIT Dashboard</h4>
                    </div>
                </div>
                <div class="pa-1" id="bottom">
                    <svg class="svg1" id="chart1"></svg>
                    <svg class="svg2" id="chart2"></svg>
                    <svg class="svg3" id="chart3"></svg>
                    <svg class="svg3" id="chart4"></svg>
                    <svg class="svg3" id="chart5"></svg>
                </div>


            </main>
        </div>
    </div>
    </script>
    <!-- <script src="https://d3js.org/d3.v7.min.js"></script> -->
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <!-- <script src="https://unpkg.com/d3-fetch"></script> -->
    <!-- <script src="https://d3js.org/d3.v3.min.js"></script> -->
    <!-- D3.js charts -->
    <!-- <script src="../js/demo/chart1.js"></script> -->
    <script src="../js/demo/barchart.js"></script>
    <!-- demo forceSimulation -->
    <script src="../js/demo/forceSimulation.js"></script>
    <!-- paralled cord chart -->
    <script src="../js/demo/parallelCord.js"></script>

    <!-- PROSIT Charts -->
    <!-- Glyph scatter plot -->
    <script src="../js/radialGlyphsPlot.js"></script>
    <script src="../js/flowerGlyphPlot.js"></script>
    <!-- Spiral time chart -->
    <script src="../js/glyph_test.js"></script>
    <!-- dummy glyph -->
    <script src="../js/glyph.js"></script>
    <!-- dummy ploar chart -->
    <script src="../js/polar_chart.js"></script>
    <script src="../js/grid.js"></script>
    <script src="../js/buffering.js"></script>

    <script>
        // glyphChart ="chart1";
        // parallelCordChart ="chart2";
        // polarChart ="chart3";
        // forcedSimulationChart ="chart4"
        // barchart ="chart5"
        var brtChecked = true;
        var accChecked = false;
        var gyrChecked = false;
        var lckChecked = false;

        function updateChart1() {
            if (toggleGlyph == "radialGlyph") {
                updateRadialGlyphs("chart1", "chart2", radius, brtChecked, accChecked, gyrChecked, lckChecked);
            } else if (toggleGlyph == "flowerGlyph") {
                updateFlowerGlyphs("chart1", "chart2", radius, brtChecked, accChecked, gyrChecked, lckChecked);
            }
        }
        updateRadialGlyphs("chart1", "chart2", radius = 10, brtChecked, accChecked, gyrChecked, lckChecked);
        parallelCord('chart3');
        // polar_chart("chart2")
        forceSimulation('chart4');
        // barchart('chart5');

        // auto refresh after window resizing
        jQuery(function($) {
            var windowWidth = $(window).width();
            var windowHeight = $(window).height();

            $(window).resize(function() {
                if (windowWidth != $(window).width() || windowHeight != $(window).height()) {
                    location.reload();
                    return;
                }
            });
        });

        //range slider 
        var slider = document.getElementById("myRange");
        var output = document.getElementById("sliderVal");
        output.innerHTML = slider.value;
        slider.oninput = function() {
            plotCharts(this.value, toggleGlyph, brtChecked, accChecked, gyrChecked, lckChecked)
            output.innerHTML = this.value;
        }

        //toggleGlyph switch
        var toggleGlyph = "radialGlyph"
        $("#toggleGlyph").on('change', function() {
            if ($(this).is(':checked')) {
                toggleGlyph = "flowerGlyph";
            } else {
                toggleGlyph = "radialGlyph";
            }
            plotCharts(slider.value, toggleGlyph, brtChecked, accChecked, gyrChecked, lckChecked)
        });

        $("#brtCheckBox").on('change', function() {
            if ($(this).is(':checked')) {
                brtChecked = true
            } else {
                brtChecked = false
            }
            plotCharts(slider.value, toggleGlyph, brtChecked, accChecked, gyrChecked, lckChecked)
        });

        $("#accCheckBox").on('change', function() {
            if ($(this).is(':checked')) {
                accChecked = true
            } else {
                accChecked = false
            }
            plotCharts(slider.value, toggleGlyph, brtChecked, accChecked, gyrChecked, lckChecked)
        });

        $("#gyrCheckBox").on('change', function() {
            if ($(this).is(':checked')) {
                gyrChecked = true
            } else {
                gyrChecked = false
            }
            plotCharts(slider.value, toggleGlyph, brtChecked, accChecked, gyrChecked, lckChecked)
        });

        $("#lckCheckBox").on('change', function() {
            if ($(this).is(':checked')) {
                lckChecked = true
            } else {
                lckChecked = false
            }
            plotCharts(slider.value, toggleGlyph, brtChecked, accChecked, gyrChecked, lckChecked)
        });

        //togglePolarChart switch
        var togglePolarChart = "circular"
        $("#togglePolarChart").on('change', function() {
            if ($(this).is(':checked')) {
                togglePolarChart = "lateral";
                // updateFlowerGlyphs("chart1","chart2", radius = slider.value);
            } else {
                toggleGlyph = "circular";
                // updateRadialGlyphs("chart1","chart2", radius = slider.value);
            }

        });


        elem = $("#bottom")[0];

        let resizeObserver = new ResizeObserver(() => {
            plotCharts(slider.value, toggleGlyph, brtChecked, accChecked, gyrChecked, lckChecked)
        });

        resizeObserver.observe(elem);

        function plotCharts(radius, toggleGlyph, brtChecked, accChecked, gyrChecked, lckChecked) {
            if (toggleGlyph == "radialGlyph") {
                updateRadialGlyphs("chart1", "chart2", radius, brtChecked, accChecked, gyrChecked, lckChecked);
            } else if (toggleGlyph == "flowerGlyph") {
                updateFlowerGlyphs("chart1", "chart2", radius, brtChecked, accChecked, gyrChecked, lckChecked);
            }
        }


        //select features dropdown
        $('#featureSelect').multiselect({
            enableClickableOptGroups: true,
            enableCollapsibleOptGroups: true,
            enableFiltering: true,
            filterPlaceholder: 'Search',
            includeSelectAllOption: true,
            buttonWidth: '140px',
            maxHeight: screen.height * 0.6,
            // buttonClass: 'btn btn-link',
            numberDisplayed: 1


        })

        //feature select filter
        $("#featureSelectFilter").click(function() {
            var data = {
                "featureColumns": $('#featureSelect').val()
            };
            console.log("Selected options\n", data["featureColumns"])
            $.ajax({
                type: "POST",
                contentType: 'application/json',
                data: JSON.stringify(data),
                url: "/dimReduceParticipants",
                success: function(status) {
                    plotCharts(slider.value, toggleGlyph, brtChecked, accChecked, gyrChecked, lckChecked)
                    if (status === "status1: file updated") {
                        console.log("FeatureData file updated")
                    }
                    if (status === "status2:single column") {
                        alert("Please select more than one column!!!")
                        console.log("FeatureData file reset: single column selected")
                    }
                    if (status === "status3:file reset") {
                        console.log("FeatureData file reset: all columns selected")
                    }
                }
            });
        });

        $.ajax({
            type: "GET",
            contentType: 'application/json',
            url: "/dimReduceParticipants",
            success: function(status) {
                plotCharts(slider.value, toggleGlyph, brtChecked, accChecked, gyrChecked, lckChecked)
                console.log(status);
            }
        });
    </script>
</body>

</html>

</html>

</html>

</html>